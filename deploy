#! /usr/bin/env bash
set -x
PLATFORM=$(uname)

if ! hash stow 2>/dev/null; then
    echo The stow command seems to be missing, please install that before proceeding
    exit
fi

case $PLATFORM in
    Darwin)
        brew tap caskroom/fonts
        brew cask install font-hack-nerd-font
        brew install cmake reattach-to-user-namespace wget
        ;;
    Linux)
        sudo apt-get -y install zsh neovim weechat tmux curl gimp
        sudo chsh -s /usr/bin/zsh "$USER"
        sudo apt-get -y install curl wget
        ;;
esac

cd "$HOME/dotfiles" || exit
git submodule update --init --recursive
mkdir ~/.zfunctions
rustup completions zsh > ~/.zfunctions/_rustup

stow config
stow emacs
stow git
stow i3
stow tmux
stow vim
stow weechat
stow zsh

# fzf
git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf
yes | ~/.fzf/install

# rust
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# starship prompt (requires rust)
cargo install starship

